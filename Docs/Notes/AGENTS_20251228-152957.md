# FoM Reverse Engineering - AGENTS

# Purpose
- We are reverse engineering this game, which no longer exists, for research/preservation; legal concerns are explicitly disregarded by project scope.
- Primary focus: FoM/FoTD client behavior, network flow, packet formats, and hook points used for server redirection and custom code injection.
- Treat FoM artifacts as baseline only; re-locate/verify in FoTD before reuse.
- Stay read-only first; only rename/add comments/types after validating with xrefs or decomp.

# Deep Context (read before Ghidra work)
- Docs\Protocol\ (server setup/flow, packet formats, handler addresses)
- Protocol_AddressWatch_FoTD.md (FoM-derived anchors to relocate in FoTD)
- LithClient_Findings.md (TS emulator analysis, reliability formats, known mismatches)
- AddressMap.md (FoM baseline hooks/signatures; leave unchanged; create AddressMap_FoTD.md for FoTD)

# AddressMap
- On session start, open `AddressMap.md` in repo root.
- Update `AddressMap.md` whenever new hook targets or renames are confirmed.

# Targets (local paths)
- C:\FoM_Decompilation\FoTD\fom_client.exe
- C:\FoM_Decompilation\FoTD\empire_rising.exe
- C:\FoM_Decompilation\FoTD\d3d9.dll
- C:\FoM_Decompilation\FoTD\server.dll

# Ghidra (current setup)
- Ghidra 12.0 installed at: C:\Users\arol_\Downloads\ghidra_12.0
- Launch: C:\Users\arol_\Downloads\ghidra_12.0\ghidraRun.bat
- Extensions installed:
  - C:\Users\arol_\Downloads\ghidra_12.0\Ghidra\Extensions\GhidrAssist
  - C:\Users\arol_\Downloads\ghidra_12.0\Ghidra\Extensions\GhidrAssistMCP

# MCP Server (GhidrAssistMCP)
- Start server in CodeBrowser: Window -> GhidrAssistMCP -> Configuration -> Enable -> Save
- Even if UI shows SSE, streamable endpoint exists at:
  - http://127.0.0.1:8080/mcp (default)
- If port changes, update Codex config and verify listener.

# Codex MCP wiring
- Codex config: C:\Users\arol_\.codex\config.toml
- Ensure:
  - [features] rmcp_client = true
  - [mcp_servers.ghidra] url = "http://127.0.0.1:8080/mcp"
- Verify: `codex mcp list` and `/mcp` in Codex TUI.
